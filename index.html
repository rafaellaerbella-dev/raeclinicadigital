<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rae ClÃ­nica Digital</title>

  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    a { display: inline-block; margin: 8px 0; }
    .card { border: 1px solid #eee; padding: 16px; border-radius: 8px; max-width: 720px; }
    #app { display:none; }
  </style>

 <script>
    (async () => {
      try {
        const r = await fetch("https://api.raeclinicadigital.com/auth/me", {
          credentials: "include"
        });
        const j = await r.json().catch(() => ({}));
        if (!j.ok) {
          window.location.href = "/auth/login.html";
          return;
        }
  
        const showApp = () => {
          const el = document.getElementById("app");
          if (el) el.style.display = "block";
        };
  
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", showApp);
        } else {
          showApp();
        }
      } catch {
        window.location.href = "/auth/login.html";
      }
    })();
  </script>
</head>

<body>
  <div id="app">
    <h1>Rae ClÃ­nica Digital</h1>

    <div class="card">
      <p>Este Ã© o seu prontuÃ¡rio pessoal (versÃ£o mÃ­nima).</p>

      <h3>NavegaÃ§Ã£o</h3>
      <a href="/paciente.html?id=demo">ðŸ“„ Abrir ficha do paciente (demo)</a><br/>
      <a href="/prescricao.html?prescritorId=30011eb5-00e8-4cb0-8c3a-f9ee64567dfd">ðŸ’Š Abrir Memed (sem paciente)</a>

      <hr/>

      <button id="logout" style="margin-top:12px; padding:8px 12px; cursor:pointer;">
        Sair
      </button>
    </div>
  </div>

  <script>
    document.getElementById("logout")?.addEventListener("click", async () => {
      await fetch("https://api.raeclinicadigital.com/auth/logout", {
        method: "POST",
        credentials: "include"
      });
      window.location.href = "/auth/login.html";
    });
  </script>
</body>
</html>
